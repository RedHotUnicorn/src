---
aliases:
- https://thisisdata.ru/blog/uchimsya-primenyat-okonnyye-funktsii/
title: –£—á–∏–º—Å—è –ø—Ä–∏–º–µ–Ω—è—Ç—å –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äì This is Data
date: 2024-04-14
src_link: https://www.notion.so/This-is-Data-e8bf570decfe44a9ba1a24e45fffd9c9
src_date: '2023-11-24 14:46:00'
gold_link: https://thisisdata.ru/blog/uchimsya-primenyat-okonnyye-funktsii/
gold_link_hash: 25d5ed7ba36f5f47bcc0e352cf959154
tags:
- '#host_thisisdata_ru'
---

–û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî —ç—Ç–æ –º–æ—â–Ω–µ–π—à–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π —Å –ª–µ–≥–∫–æ—Å—Ç—å—é –ø–æ–º–æ–≥–∞–µ—Ç —Ä–µ—à–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á.
–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞–¥ –∑–∞–¥–∞–Ω–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º —Å—Ç—Ä–æ–∫, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –∫–∞–∫–∏–º-—Ç–æ –æ–¥–Ω–∏–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–º –∫–ª–∏–µ–Ω—Ç–∞, –≤–∞–º –Ω–∞ –ø–æ–º–æ—â—å –ø—Ä–∏–¥—É—Ç –∏–º–µ–Ω–Ω–æ –æ–Ω–∏.
–ú–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å –∏—Ö —Å –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏, –Ω–æ, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –æ–±—ã—á–Ω–æ–π –∞–≥—Ä–µ–≥–∞—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏, –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–∫–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –Ω–µ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –≤ –æ–¥–Ω—É, –∞ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ. –ü—Ä–∏ —ç—Ç–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∫ —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ –∫–∞–∫ –µ—â–µ –æ–¥–Ω–æ –ø–æ–ª–µ. –≠—Ç–æ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á–µ—Ç–æ–≤, —Ä–∞—Å—á–µ—Ç–∞ —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ –∏ –Ω–∞—Ä–∞—Å—Ç–∞—é—â–∏—Ö –∏—Ç–æ–≥–æ–≤, –∞ —Ç–∞–∫–∂–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∞—Ç—Ä–∏–±—É—Ü–∏–∏.
## –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã
–£ –≤–∞—Å –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –≤–æ–ø—Ä–æ—Å ‚Äì ¬´–ß—Ç–æ –∑–Ω–∞—á–∏—Ç –æ–∫–æ–Ω–Ω—ã–µ?¬ª
–ü—Ä–∏ –æ–±—ã—á–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ, –≤—Å–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –±—ã –µ–¥–∏–Ω—ã–º ¬´—Ü–µ–ª—å–Ω—ã–º –∫—É—Å–∫–æ–º¬ª, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ —Å—á–∏—Ç–∞—é—Ç—Å—è –∞–≥—Ä–µ–≥–∞—Ç—ã. –ê –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∑–∞–ø—Ä–æ—Å –¥–µ–ª–∏—Ç—Å—è –Ω–∞ —á–∞—Å—Ç–∏ (–æ–∫–Ω–∞) –∏ —É–∂–µ –¥–ª—è –∫–∞–∂–¥–æ–π –∏–∑ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —á–∞—Å—Ç–µ–π —Å—á–∏—Ç–∞—é—Ç—Å—è —Å–≤–æ–∏ –∞–≥—Ä–µ–≥–∞—Ç—ã.
## –°–∏–Ω—Ç–∞–∫—Å–∏—Å
–û–∫–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ OVER(). –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —ç—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:

```
SELECT –ù–∞–∑–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (—Å—Ç–æ–ª–±–µ—Ü –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π) OVER ( PARTITION BY —Å—Ç–æ–ª–±–µ—Ü –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ ORDER BY —Å—Ç–æ–ª–±–µ—Ü –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ ROWS –∏–ª–∏ RANGE –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –≥—Ä—É–ø–ø—ã )
```

–¢–µ–ø–µ—Ä—å —Ä–∞–∑–±–µ—Ä–µ–º –∫–∞–∫ –ø–æ–≤–µ–¥–µ—Ç —Å–µ–±—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ç–æ–≥–æ –∏–ª–∏ –∏–Ω–æ–≥–æ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏. –ê —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è –±—É–¥–µ–º –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π —Ç–∞–±–ª–∏—á–∫–µ —Å–æ–¥–µ—Ä–∂–∞—â–µ–π –¥–∞—Ç—É, –∫–∞–Ω–∞–ª —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏—à–µ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–Ω–≤–µ—Ä—Å–∏–π:
### OVER()
–û—Ç–∫—Ä–æ–µ–º –æ–∫–Ω–æ –ø—Ä–∏ –ø–æ–º–æ—â–∏ OVER() –∏ –ø—Ä–æ—Å—É–º–º–∏—Ä—É–µ–º —Å—Ç–æ–ª–±–µ—Ü ¬´Conversions¬ª:

```
SELECT Date , Medium , Conversions , SUM(Conversions) OVER() AS 'Sum' FROM Orders
```

–ú—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é OVER() –±–µ–∑ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π. –í —Ç–∞–∫–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –æ–∫–Ω–æ–º –±—É–¥–µ—Ç –≤–µ—Å—å –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∏–∫–∞–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è. –ü–æ—è–≤–∏–ª—Å—è –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü ¬´Sum¬ª –∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ 14. –≠—Ç–æ —Å–∫–≤–æ–∑–Ω–∞—è —Å—É–º–º–∞ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ–ª–æ–Ω–∫–∏ ¬´Conversions¬ª.
### PARTITION BY
–¢–µ–ø–µ—Ä—å –ø—Ä–∏–º–µ–Ω–∏–º –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é PARTITION BY, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç–æ–ª–±–µ—Ü, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –±—É–¥–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∏ —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–µ–≤–æ–π –≤ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏ –Ω–∞–±–æ—Ä–∞ —Å—Ç—Ä–æ–∫ –Ω–∞ –æ–∫–Ω–∞:

```
SELECT Date , Medium , Conversions , SUM(Conversions) OVER(PARTITION BY Date) AS 'Sum' FROM Orders
```

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è PARTITION BY —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–ª–∞ —Å—Ç—Ä–æ–∫–∏ –ø–æ –ø–æ–ª—é ¬´Date¬ª. –¢–µ–ø–µ—Ä—å –¥–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å–≤–æ—è —Å—É–º–º–∞ –∑–Ω–∞—á–µ–Ω–∏–π —Å—Ç–æ–ª–±—Ü–∞ ¬´Conversions¬ª.
### ORDER BY
–ü–æ–ø—Ä–æ–±—É–µ–º –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ –æ–∫–Ω–∞ –ø—Ä–∏ –ø–æ–º–æ—â–∏ ORDER BY:

```
SELECT Date , Medium , Conversions , SUM(Conversions) OVER(PARTITION BY Date ORDER BY Medium) AS 'Sum' FROM Orders
```

–ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—é PARTITION BY –¥–æ–±–∞–≤–∏–ª–æ—Å—å ORDER BY –ø–æ –ø–æ–ª—é ¬´Medium¬ª. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã —É–∫–∞–∑–∞–ª–∏, —á—Ç–æ —Ö–æ—Ç–∏–º –≤–∏–¥–µ—Ç—å —Å—É–º–º—É –Ω–µ –≤—Å–µ—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –æ–∫–Ω–µ, –∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è ¬´Conversions¬ª —Å—É–º–º—É —Å–æ –≤—Å–µ–º–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏. –¢–æ –µ—Å—Ç—å –º—ã –ø–æ—Å—á–∏—Ç–∞–ª–∏ –Ω–∞—Ä–∞—Å—Ç–∞—é—â–∏–π –∏—Ç–æ–≥.
### ROWS –∏–ª–∏ RANGE
–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è ROWS –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ –≤ –æ–∫–Ω–µ, —É–∫–∞–∑—ã–≤–∞—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫, –ø—Ä–µ–¥—à–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–ª–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞ —Ç–µ–∫—É—â–µ–π.
–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è RANGE, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç ROWS, —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏, –∞ —Å –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º —Å—Ç—Ä–æ–∫ –≤ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ ORDER BY. –¢–æ –µ—Å—Ç—å –ø–æ–¥ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π –¥–ª—è RANGE –º–æ–≥—É—Ç –ø–æ–Ω–∏–º–∞—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä–æ–∫ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø–æ —Ä–∞–Ω–≥—É.
–û–±–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ ROWS –∏ RANGE –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å ORDER BY.
–í –≤—ã—Ä–∞–∂–µ–Ω–∏–∏ –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ ROWS –∏–ª–∏ RANGE —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞:
**UNBOUNDED PRECEDING**‚Äî —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –æ–∫–Ω–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏ –≥—Ä—É–ø–ø—ã;**UNBOUNDED FOLLOWING**‚Äì —Å –ø–æ–º–æ—â—å—é –¥–∞–Ω–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å, —á—Ç–æ –æ–∫–Ω–æ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å—Ç—Ä–æ–∫–µ –≥—Ä—É–ø–ø—ã;**CURRENT ROW**‚Äì –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –æ–∫–Ω–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∏–ª–∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–µ;**BETWEEN****¬´**‚Äî —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∏–∂–Ω—é—é –∏ –≤–µ—Ä—Ö–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É –æ–∫–Ω–∞;*–≥—Ä–∞–Ω–∏—Ü–∞ –æ–∫–Ω–∞*¬ª AND ¬´*–≥—Ä–∞–Ω–∏—Ü–∞ –æ–∫–Ω–∞*¬ª**¬´***–ó–Ω–∞—á–µ–Ω–∏–µ*¬ª**PRECEDING**‚Äì –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —á–∏—Å–ª–æ —Å—Ç—Ä–æ–∫ –ø–µ—Ä–µ–¥ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–æ–π (–Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ RANGE).;**¬´***–ó–Ω–∞—á–µ–Ω–∏–µ*¬ª**FOLLOWING**‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —á–∏—Å–ª–æ —Å—Ç—Ä–æ–∫ –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏ (–Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ RANGE).–†–∞–∑–±–µ—Ä–µ–º –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ:

```
SELECT Date , Medium , Conversions , SUM(Conversions) OVER(PARTITION BY Date ORDER BY Conversions ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING) AS 'Sum' FROM Orders
```

–í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —Å—É–º–º–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ç–µ–∫—É—â–µ–π –∏ —Å–ª–µ–¥—É—é—â–µ–π —è—á–µ–π–∫–µ –≤ –æ–∫–Ω–µ. –ê –ø–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç—Ä–æ–∫–∞ –≤ –æ–∫–Ω–µ –∏–º–µ–µ—Ç —Ç–æ –∂–µ –∑–Ω–∞—á–µ–Ω–∏–µ, —á—Ç–æ –∏ —Å—Ç–æ–ª–±–µ—Ü ¬´Conversions¬ª, –ø–æ—Ç–æ–º—É —á—Ç–æ –±–æ–ª—å—à–µ –Ω–µ —Å —á–µ–º —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å.
–ö–æ–º–±–∏–Ω–∏—Ä—É—è –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞, –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–¥–æ–≥–Ω–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω —Ä–∞–±–æ—Ç—ã –æ–∫–æ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–¥ –≤–∞—à—É —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫—É—é –∑–∞–¥–∞—á—É.
## –í–∏–¥—ã —Ñ—É–Ω–∫—Ü–∏–π
–û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –≥—Ä—É–ø–ø—ã:
–ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏;
-
–†–∞–Ω–∂–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏;
-
–§—É–Ω–∫—Ü–∏–∏ —Å–º–µ—â–µ–Ω–∏—è;
-
–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏.
-
–í –æ–¥–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ SELECT —Å –æ–¥–Ω–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º FROM –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. –î–∞–≤–∞–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞–∑–±–µ—Ä–µ–º –∫–∞–∂–¥—É—é –≥—Ä—É–ø–ø—É –∏ –ø—Ä–æ–π–¥–µ–º—Å—è –ø–æ –æ—Å–Ω–æ–≤–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º.
### –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
–ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äì —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç –Ω–∞ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∏—Ç–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.
**SUM**‚Äì –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—É–º–º—É –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å—Ç–æ–ª–±—Ü–µ;**COUNT**‚Äî –≤—ã—á–∏—Å–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Å—Ç–æ–ª–±—Ü–µ (*–∑–Ω–∞—á–µ–Ω–∏—è NULL –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è*);**AVG**‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å—Ç–æ–ª–±—Ü–µ;**MAX**‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å—Ç–æ–ª–±—Ü–µ;**MIN**‚Äî –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å—Ç–æ–ª–±—Ü–µ.–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π —Å –æ–∫–æ–Ω–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π OVER:

```
SELECT Date , Medium , Conversions , SUM(Conversions) OVER(PARTITION BY Date) AS 'Sum' , COUNT(Conversions) OVER(PARTITION BY Date) AS 'Count' , AVG(Conversions) OVER(PARTITION BY Date) AS 'Avg' , MAX(Conversions) OVER(PARTITION BY Date) AS 'Max' , MIN(Conversions) OVER(PARTITION BY Date) AS 'Min' FROM Orders
```

### –†–∞–Ω–∂–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
–†–∞–Ω–∂–∏—Ä—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äì —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–Ω–∂–∏—Ä—É—é—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ –æ–∫–Ω–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –∏—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–∏—Å–≤–æ–∏—Ç—å –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–µ –∏–ª–∏ —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥.
**ROW_NUMBER**‚Äì —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω—É–º–µ—Ä–∞—Ü–∏–∏;**RANK**‚Äî —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–Ω–≥ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–∂–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∏, –≤ —Å–ª—É—á–∞–µ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–∞–Ω–≥ —Å –ø—Ä–æ–ø—É—Å–∫–æ–º —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è;**DENSE_RANK**‚Äî —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–Ω–≥ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏. –ù–æ –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ RANK, –æ–Ω–∞ –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–Ω–≥, –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞—è —Å–ª–µ–¥—É—é—â–∏–π;**NTILE**‚Äì —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫ –∫–∞–∫–æ–π –≥—Ä—É–ø–ø–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è —Ç–µ–∫—É—â–∞—è —Å—Ç—Ä–æ–∫–∞. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–ø–ø –∑–∞–¥–∞–µ—Ç—Å—è –≤ —Å–∫–æ–±–∫–∞—Ö.
```
SELECT Date , Medium , Conversions , ROW_NUMBER() OVER(PARTITION BY Date ORDER BY Conversions) AS 'Row_number' , RANK() OVER(PARTITION BY Date ORDER BY Conversions) AS 'Rank' , DENSE_RANK() OVER(PARTITION BY Date ORDER BY Conversions) AS 'Dense_Rank' , NTILE(3) OVER(PARTITION BY Date ORDER BY Conversions) AS 'Ntile' FROM Orders
```

### –§—É–Ω–∫—Ü–∏–∏ —Å–º–µ—â–µ–Ω–∏—è
–§—É–Ω–∫—Ü–∏–∏ —Å–º–µ—â–µ–Ω–∏—è ‚Äì —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –∏ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Ä–∞–∑–Ω—ã–º —Å—Ç—Ä–æ–∫–∞–º –≤ –æ–∫–Ω–µ, –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–∏, –∞ —Ç–∞–∫–∂–µ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º –≤ –Ω–∞—á–∞–ª–µ –∏–ª–∏ –≤ –∫–æ–Ω—Ü–µ –æ–∫–Ω–∞.
**LAG –∏–ª–∏****LEAD**‚Äì —Ñ—É–Ω–∫—Ü–∏—è LAG –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –¥–∞–Ω–Ω—ã–º –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–æ–∫–∏ –æ–∫–Ω–∞, –∞ LEAD –∫ –¥–∞–Ω–Ω—ã–º –∏–∑ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–∏. –§—É–Ω–∫—Ü–∏—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∏–ª–∏ —Å–ª–µ–¥—É—é—â–∏–º. –ò–º–µ–µ—Ç —Ç—Ä–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞: —Å—Ç–æ–ª–±–µ—Ü, –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–µ—Ä–Ω—É—Ç—å, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –¥–ª—è —Å–º–µ—â–µ–Ω–∏—è (*–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1*), –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–µ—Ä–Ω—É—Ç—å –µ—Å–ª–∏ –ø–æ—Å–ª–µ —Å–º–µ—â–µ–Ω–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ NULL;**FIRST_VALUE**–∏–ª–∏**LAST_VALUE**‚Äî —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤–æ–µ –∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –æ–∫–Ω–µ. –í –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å—Ç–æ–ª–±–µ—Ü, –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–µ—Ä–Ω—É—Ç—å.
```
SELECT Date , Medium , Conversions , LAG(Conversions) OVER(PARTITION BY Date ORDER BY Date) AS 'Lag' , LEAD(Conversions) OVER(PARTITION BY Date ORDER BY Date) AS 'Lead' , FIRST_VALUE(Conversions) OVER(PARTITION BY Date ORDER BY Date) AS 'First_Value' , LAST_VALUE(Conversions) OVER(PARTITION BY Date ORDER BY Date) AS 'Last_Value' FROM Orders
```

### –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.
**CUME_DIST**‚Äî –≤—ã—á–∏—Å–ª—è–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ) –∑–Ω–∞—á–µ–Ω–∏–π –≤ –æ–∫–Ω–µ;**PERCENT_RANK**‚Äî –≤—ã—á–∏—Å–ª—è–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π —Ä–∞–Ω–≥ —Å—Ç—Ä–æ–∫–∏ –≤ –æ–∫–Ω–µ;**PERCENTILE_CONT**‚Äî –≤—ã—á–∏—Å–ª—è–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ç–æ–ª–±—Ü–∞. –í –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã—á–∏—Å–ª–∏—Ç—å (–≤[—ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ](http://thisisdata.ru/blog/kak-pravilno-vychislit-sredneye-znacheniye/)—è —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—é –∫–∞–∫ –ø–æ—Å—á–∏—Ç–∞—Ç—å –º–µ–¥–∏–∞–Ω—É, –±–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏);**PERCENTILE_DISC**‚Äî –≤—ã—á–∏—Å–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å –¥–ª—è –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö. –í –∫–∞—á–µ—Å—Ç–≤–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–∏–ª—å, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã—á–∏—Å–ª–∏—Ç—å.–í–∞–∂–Ω–æ! –£ —Ñ—É–Ω–∫—Ü–∏–π PERCENTILE_CONT –∏ PERCENTILE_DISC, —Å—Ç–æ–ª–±–µ—Ü, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞ WITHIN GROUP.

```
SELECT Date , Medium , Conversions , CUME_DIST() OVER(PARTITION BY Date ORDER BY Conversions) AS 'Cume_Dist' , PERCENT_RANK() OVER(PARTITION BY Date ORDER BY Conversions) AS 'Percent_Rank' , PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY Conversions) OVER(PARTITION BY Date) AS 'Percentile_Cont' , PERCENTILE_DISC(0.5) WITHIN GROUP (ORDER BY Conversions) OVER(PARTITION BY Date) AS 'Percentile_Disc' FROM Orders
```

## –ö–µ–π—Å. –ú–æ–¥–µ–ª–∏ –∞—Ç—Ä–∏–±—É—Ü–∏–∏
–ë–ª–∞–≥–æ–¥–∞—Ä—è –º–æ–¥–µ–ª–∏ –∞—Ç—Ä–∏–±—É—Ü–∏–∏ –º–æ–∂–Ω–æ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –≤–∫–ª–∞–¥ –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞ –≤ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏. –î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º –ø–æ—Å—á–∏—Ç–∞—Ç—å –¥–≤–µ —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–∏ –∞—Ç—Ä–∏–±—É—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.
–£ –Ω–∞—Å –µ—Å—Ç—å —Ç–∞–±–ª–∏—Ü–∞ —Å id –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è (–∏–º –º–æ–∂–µ—Ç –±—ã—Ç—å [Client ID](http://thisisdata.ru/blog/chto-takoye-client-id-v-google-analytics/), –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏ —Ç–ø.), –¥–∞—Ç–∞–º–∏ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ—Å–µ—â–µ–Ω–∏–π —Å–∞–π—Ç–∞, –∞ —Ç–∞–∫–∂–µ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã—Ö –∫–æ–Ω–≤–µ—Ä—Å–∏—è—Ö.
### –ü–µ—Ä–≤—ã–π –∫–ª–∏–∫
–í Google Analytics —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –º–æ–¥–µ–ª—å—é –∞—Ç—Ä–∏–±—É—Ü–∏–∏ —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–π –Ω–µ–ø—Ä—è–º–æ–π –∫–ª–∏–∫. –ò –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ 100% —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–µ–º—É –∫–∞–Ω–∞–ª—É –≤ —Ü–µ–ø–æ—á–∫–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.
–ü–æ–ø—Ä–æ–±—É–µ–º –ø–æ—Å—á–∏—Ç–∞—Ç—å –º–æ–¥–µ–ª—å –ø–æ –ø–µ—Ä–≤–æ–º—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—é, –∫–æ–≥–¥–∞ 100% —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–µ—Ç—Å—è –ø–µ—Ä–≤–æ–º—É –∫–∞–Ω–∞–ª—É –≤ —Ü–µ–ø–æ—á–∫–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ FIRST_VALUE.

```
SELECT Date , Client_ID , Medium , FIRST_VALUE(Medium) OVER(PARTITION BY Client_ID ORDER BY Date) AS 'First_Click' , Sessions , Conversions FROM Orders
```

–†—è–¥–æ–º —Å–æ —Å—Ç–æ–ª–±—Ü–æ–º ¬´Medium¬ª –ø–æ—è–≤–∏–ª—Å—è –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü ¬´First_Click¬ª, –≤ –∫–æ—Ç–æ—Ä–æ–º —É–∫–∞–∑–∞–Ω –∫–∞–Ω–∞–ª –≤ –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –ø—Ä–∏–≤–µ–¥—à–∏–π –ø–æ—Å–µ—Ç–∏—Ç–µ–ª—è –∫ –Ω–∞–º –Ω–∞ —Å–∞–π—Ç –∏ –≤—Å—è —Ü–µ–Ω–Ω–æ—Å—Ç—å –∑–∞—á—Ç–µ–Ω–∞ –¥–∞–Ω–Ω–æ–º—É –∫–∞–Ω–∞–ª—É.
–ü—Ä–æ–∏–∑–≤–µ–¥–µ–º –∞–≥—Ä–µ–≥–∞—Ü–∏—é –∏ –ø–æ–ª—É—á–∏–º –æ—Ç—á–µ—Ç.

```
WITH First AS ( SELECT Date , Client_ID , Medium , FIRST_VALUE(Medium) OVER(PARTITION BY Client_ID ORDER BY Date) AS 'First_Click' , Sessions , Conversions FROM Orders ) SELECT First_Click , SUM(Conversions) AS 'Conversions' FROM First GROUP BY First_Click
```

### –° —É—á–µ—Ç–æ–º –¥–∞–≤–Ω–æ—Å—Ç–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–æ: —á–µ–º –±–ª–∏–∂–µ –∫ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ç–æ—á–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è, —Ç–µ–º –±–æ–ª–µ–µ —Ü–µ–Ω–Ω–æ–π –æ–Ω–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è. –ü–æ–ø—Ä–æ–±—É–µ–º —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —ç—Ç—É –º–æ–¥–µ–ª—å –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Ñ—É–Ω–∫—Ü–∏–∏ DENSE_RANK.

```
SELECT Date , Client_ID , Medium -- –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º —Ä–∞–Ω–≥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –±–ª–∏–∑–æ—Å—Ç–∏ –∫ –¥–∞—Ç–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ , DENSE_RANK() OVER(PARTITION BY Client_ID ORDER BY Date) AS 'Ranks' , Sessions , Conversions FROM Orders
```

–†—è–¥–æ–º —Å–æ —Å—Ç–æ–ª–±—Ü–æ–º ¬´Medium¬ª –ø–æ—è–≤–∏–ª—Å—è –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü ¬´Ranks¬ª, –≤ –∫–æ—Ç–æ—Ä–æ–º —É–∫–∞–∑–∞–Ω —Ä–∞–Ω–≥ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –±–ª–∏–∑–æ—Å—Ç–∏ –∫ –¥–∞—Ç–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏.
–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ–º —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ü–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞–≤–Ω—É—é 1 (100%) –ø–æ –≤—Å–µ–º —Ç–æ—á–∫–∞–º –Ω–∞ –ø—É—Ç–∏ –∫ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏.

```
SELECT Date , Client_ID , Medium -- –î–µ–ª–∏–º —Ä–∞–Ω–≥ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –Ω–∞ —Å—É–º–º—É —Ä–∞–Ω–≥–æ–≤ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é , ROUND(CAST(DENSE_RANK() OVER(PARTITION BY Client_ID ORDER BY Date) AS FLOAT) / CAST(SUM(ranks) OVER(PARTITION BY Client_ID) AS FLOAT), 2) AS 'Time_Decay' , Sessions , Conversions FROM ( SELECT Date , Client_ID , Medium -- –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º —Ä–∞–Ω–≥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –±–ª–∏–∑–æ—Å—Ç–∏ –∫ –¥–∞—Ç–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ , DENSE_RANK() OVER(PARTITION BY Client_ID ORDER BY Date) AS 'Ranks' , Sessions , Conversions FROM Orders ) rank_table
```

–†—è–¥–æ–º —Å–æ —Å—Ç–æ–ª–±—Ü–æ–º ¬´Medium¬ª –ø–æ—è–≤–∏–ª—Å—è –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü ¬´Time_Decay¬ª —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç—å—é.
–ò —Ç–µ–ø–µ—Ä—å, –µ—Å–ª–∏ —Å–¥–µ–ª–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ü–∏—é, –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –∫–∞–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏–ª–∞—Å—å —Ü–µ–Ω–Ω–æ—Å—Ç—å –ø–æ –∫–∞–Ω–∞–ª–∞–º.

```
WITH Ranks AS ( SELECT Date , Client_ID , Medium -- –î–µ–ª–∏–º —Ä–∞–Ω–≥ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –Ω–∞ —Å—É–º–º—É —Ä–∞–Ω–≥–æ–≤ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é , ROUND(CAST(DENSE_RANK() OVER(PARTITION BY Client_ID ORDER BY Date) AS FLOAT) / CAST(SUM(ranks) OVER(PARTITION BY Client_ID) AS FLOAT), 2) AS 'Time_Decay' , Sessions , Conversions FROM ( SELECT Date , Client_ID , Medium -- –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º —Ä–∞–Ω–≥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –±–ª–∏–∑–æ—Å—Ç–∏ –∫ –¥–∞—Ç–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ , DENSE_RANK() OVER(PARTITION BY Client_ID ORDER BY Date) AS 'Ranks' , Sessions , Conversions FROM Orders ) rank_table ) SELECT Medium , SUM(Time_Decay) AS 'Value' , SUM(Conversions) AS 'Conversions' FROM Ranks GROUP BY Medium ORDER BY Value DESC
```

–ò–∑ –ø–æ–ª—É—á–∏–≤—à–µ–≥–æ—Å—è –æ—Ç—á–µ—Ç–∞ –≤–∏–¥–Ω–æ, —á—Ç–æ —Å–∞–º—ã–º –≤–µ—Å–æ–º—ã–º –∫–∞–Ω–∞–ª–æ–º —è–≤–ª—è–µ—Ç—Å—è –∫–∞–Ω–∞–ª ¬´cpc¬ª, –∞ –∫–∞–Ω–∞–ª ¬´cpa¬ª, –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –±—ã –∏—Å–∫–ª—é—á–µ–Ω –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏ –∞—Ç—Ä–∏–±—É—Ü–∏–∏, —Ç–æ–∂–µ –ø–æ–ª—É—á–∏–ª —Å–≤–æ—é –¥–æ–ª—é –ø—Ä–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏.
**–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏:**[SELECT ‚Äî –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ OVER (Transact-SQL)](https://docs.microsoft.com/ru-ru/sql/t-sql/queries/select-over-clause-transact-sql?view=sql-server-ver15)[–ö–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–∫–æ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –≤ Google BigQuery ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ](https://netpeak.net/ru/blog/kak-rabotat-s-okonnymi-funktsiyami-v-google-bigquery-podrobnoe-rukovodstvo/)[–ú–æ–¥–µ–ª—å –∞—Ç—Ä–∏–±—É—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–Ω–ª–∞–π–Ω/–æ—Ñ–ª–∞–π–Ω –¥–∞–Ω–Ω—ã—Ö –≤ Google BigQuery](https://medium.com/@dmitriilin/custom-attribution-using-google-bigquery-online-offline-data-af3f5cdb77ad)[–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –≥–∏–ø–æ—Ç–µ–∑–∞–º–∏?](https://thisisdata.ru/blog/kak-pravilno-organizovat-rabotu-s-gipotezami/)- 21.11.2023[–ö–µ–π—Å: –∫–∞–∫ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–¥–µ–ª –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤ –±–æ–ª—å—à–æ–π –∫–æ–º–ø–∞–Ω–∏–∏?](https://thisisdata.ru/blog/keys-kak-postroit-otdel-analitiki-v-bolshoy-kompanii/)- 06.05.2022[–£—á–∏–º—Å—è –ø—Ä–∏–º–µ–Ω—è—Ç—å –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏](https://thisisdata.ru/blog/uchimsya-primenyat-okonnyye-funktsii/)- 29.09.2020
## 15 replies on ‚Äú –£—á–∏–º—Å—è –ø—Ä–∏–º–µ–Ω—è—Ç—å –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äù
–•–æ—Ä–æ—à–∞—è —Å—Ç–∞—Ç—å—è. –ù–∞—á–∏–Ω–∞—é—â–∏–º –∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º —Ç–æ—á–Ω–æ –±—É–¥–µ—Ç –ø–æ–ª–µ–∑–Ω–æ–π.
–ë—ã–ª–æ –±—ã –∫—Ä—É—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–µ–π—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º IGNORE NULLS, –∏–Ω–æ–≥–¥–∞ –±–µ–∑ –Ω–µ–≥–æ –Ω–∏–∫–∞–∫ üôÇ
–ï—â–µ, –µ—Å—Ç—å –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö FIRST_VALUE –∏ LAST_VALUE, –æ –∫–æ—Ç–æ—Ä–æ–π —Ä–µ–¥–∫–æ –ø–∏—à—É—Ç, –æ–Ω–∏ –Ω–µ –≤—Å–µ–≥–¥–∞ –≤—ã–¥–∞—é—Ç –æ–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –¢—É—Ç –ø–æ–¥—Ä–æ–±–Ω–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–æ –ø–æ—á–µ–º—É —Ç–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç ‚Äî https://stackoverflow.com/questions/35096414/why-doesnt-last-value-return-the-last-value
–ü–æ—ç—Ç–æ–º—É, —è –≤—Å–µ–≥–¥–∞ –≤ –Ω–∏—Ö –∏—Å–ø–æ–ª—å–∑—É—é ORDER BY field ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
–°–ø–∞—Å–∏–±–æ –∑–∞ –¥–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è)
–°—É–ø–µ—Ä —Å—Ç–∞—Ç—å—è! –ù–∞–ø–∏—Å–∞–Ω–æ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ –∏ –Ω–∞–≥–ª—è–¥–Ω–æ.
–û—Ç–ø—Ä–∞–≤–∏–ª —Å—ã–Ω—É –∏–∑—É—á–∞—Ç—å.
–†–æ–º–∞–Ω, —Å–ø–∞—Å–∏–±–æ! –ü–∏—à–∏ –µ—â–µ)
–û—Ç–ª–∏—á–Ω–∞—è —Å—Ç–∞—Ç—å—è! –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è —Å—Ç–∞—Ç—å—è, –∏–∑ –∫–æ—Ç–æ—Ä–æ–π –ø–æ–Ω—è–ª –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏. –î–æ–±–∞–≤–∏–ª –≤ –∑–∞–∫–ª–∞–¥–∫–∏.
–î–∞, —Ö–æ—Ä–æ—à–∏–π —Ç–µ–∫—Å—Ç, –≤—Å–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–æ –ø–æ –ø–æ–ª–æ—á–∫–∞–º. –°—Å—ã–ª–∫—É —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞. –°–ø–∞—Å–∏–±–æ –∞–≤—Ç–æ—Ä—É!
> ¬´–ó–Ω–∞—á–µ–Ω–∏–µ¬ª PRECEDING ‚Äì –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —á–∏—Å–ª–æ —Å—Ç—Ä–æ–∫ –ø–µ—Ä–µ–¥ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–æ–∫–æ–π (–Ω–µ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ RANGE)
–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –°–£–ë–î (–Ω–∞–ø—Ä–∏–º–µ—Ä, Oracle) –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è. –¢–æ–ª—å–∫–æ —Ç–∞–º –¥–ª—è RANGE ¬´–∑–Ω–∞—á–µ–Ω–∏–µ¬ª ‚Äî —ç—Ç–æ –≤–µ–ª–∏—á–∏–Ω–∞ –ø–æ–ª—è, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É —Å–æ—Ä—Ç–∏—Ä—É–µ–º, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é –Ω–∞–¥–æ –æ—Ç—Å—Ç—É–ø–∏—Ç—å. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ, –∏ –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å RANGE BETWEEN INTERVAL ‚Äò1‚Äô MONTH PRECEDING AND INTERVAL ‚Äò1‚Äô DAY FOLLOWING
–ü—Ä–∏–º–µ—Ä:
https://docs.oracle.com/cd/E11882_01/server.112/e25554/analysis.htm#DWHSG021
–°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ, —ç—Ç–æ, –Ω–∞ –º–æ–π –≤–∑–≥–ª—è–¥, –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ–∏—à–∫–∞ –æ–ø—Ü–∏–∏ RANGE ‚Äî —á—Ç–æ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –æ–∫–Ω–æ –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É. –ù–∞–ø—Ä–∏–º–µ—Ä ‚Äî –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—É –ø–æ –≤—Å–µ–º –±–∞–Ω–∫–æ–≤—Å–∫–∏–º –æ–ø–µ—Ä–∞—Ü–∏—è–º –≤ –æ–∫–Ω–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–µ—Å—è—Ü–∞.
–°–ø–∞—Å–∏–±–æ, –∑–∞ —Å—Ç–∞—Ç—å—é! –û—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ –Ω–∞–ø–∏—Å–∞–Ω–æ –∏ –æ–±—ä—è—Å–Ω–µ–Ω–æ.
–û—Ç–ª–∏—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –ª–∞–∫–æ–Ω–∏—á–Ω–∞—è —Å –Ω–∞–≥–ª—è–¥–Ω—ã–º–∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏. –Ø –≤—ã—Å–æ–∫–æ –æ—Ü–µ–Ω–∏–ª–∞ –ø–æ–ª—É—á–µ–Ω–Ω—É—é —ç–∫–æ–Ω–æ–º–∏—é –≤—Ä–µ–º–µ–Ω–∏. –ë–ª–∞–≥–æ–¥–∞—Ä—é, –†–æ–º–∞–Ω.
–°–º–æ—Ç—Ä–µ–ª —Å—Ç–∞—Ç—å–∏ –Ω–∞ –º–Ω–æ–≥–∏—Ö —Å–∞–π—Ç–∞—Ö, –Ω–∞ —ç—Ç–æ–º —Å–∞–º–æ–µ –ø–æ–Ω—è—Ç–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ. –°–ø–∞—Å–∏–±–æ
–ü–æ–∫–∞ —Å–∞–º–∞—è –ø–æ–Ω—è—Ç–Ω–∞—è —Å—Ç–∞—Ç—å—è –ø—Ä–æ –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, —á—Ç–æ —è –≤–∏–¥–µ–ª. –°–ø–∞—Å–∏–±–æ!
–†–µ–∞–ª—å–Ω–æ —Ö–æ—á—É —Å–∫–∞–∑–∞—Ç—å —Å–ø–∞—Å–∏–±–æ –∞–≤—Ç–æ—Ä—É. –ß–∏—Ç–∞–ª –º–Ω–æ–≥–æ, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª —á–∞—Å—Ç–æ, –Ω–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≤–µ—â–∏ –æ—Ç–∫—Ä—ã–ª–∏—Å—å —Å –Ω–æ–≤–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –∏ –≤—Å—ë –ø–æ–Ω—è—Ç–Ω–æ.
–ü—Ä–µ–¥–ª–∞–≥–∞—é –æ–±—Å—É–¥–∏—Ç—å —Å–ª—É—á–∞–∏:
1) –∫–æ–≥–¥–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–π –Ω–µ—Å–∫–æ–ª—å–∫–æ
2) –∫–æ–≥–¥–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ (—Ä–∞–∑–æ–±—Ä–∞–Ω —Å–ª—É—á–∞–π –∫–æ–≥–¥–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–µ—Å—Å–∏–∏)
> –∫–æ–≥–¥–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–π –Ω–µ—Å–∫–æ–ª—å–∫–æ
–¢—É—Ç —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–∞—à–∏—Ö –∑–∞–¥–∞—á, –∏–º–µ–µ—Ç–µ –≤–≤–∏–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–∫—Ä–æ–∫–æ–Ω–≤–µ—Ä—Å–∏–π –Ω–∞ –ø—É—Ç–∏ –∫ –æ—Å–Ω–æ–≤–Ω–æ–π?
–ù–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Å—Å–∏—è > —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è > –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É > –ø–æ–∫—É–ø–∫–∞?
> –∫–æ–≥–¥–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ (—Ä–∞–∑–æ–±—Ä–∞–Ω —Å–ª—É—á–∞–π –∫–æ–≥–¥–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–µ—Å—Å–∏–∏)
–¢—É—Ç —É–∂–µ –Ω–∞–¥–æ –¥—É–º–∞—Ç—å –æ–± –∞—Ç—Ä–∏–±—É—Ü–∏–æ–Ω–Ω–æ–º –æ–∫–Ω–µ, –∫–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—É–¥—É—Ç –ø–æ–ø–∞–¥–∞—Ç—å –≤ —Ä–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–π –º–æ–¥–µ–ª–∏, –∞ –∫–∞–∫–∏–µ –Ω–µ—Ç.